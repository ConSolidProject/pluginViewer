(self.webpackChunkviewer=self.webpackChunkviewer||[]).push([[401],{95318:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.default=t.exports,t.exports.__esModule=!0},20862:(t,e,r)=>{var n=r(50008).default;function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}t.exports=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==n(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var s=o?Object.getOwnPropertyDescriptor(t,i):null;s&&(s.get||s.set)?Object.defineProperty(r,i,s):r[i]=t[i]}return r.default=t,e&&e.set(t,r),r},t.exports.default=t.exports,t.exports.__esModule=!0},50008:t=>{function e(r){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(r)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0},89875:(t,e,r)=>{"use strict";var n=r(95318),a=r(20862);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(r(77865)),i=(0,n(r(2108)).default)(o.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft");e.default=i},2108:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=r(28546)},1487:(t,e,r)=>{"use strict";r.r(e),r.d(e,{checkExistence:()=>f,checkInvites:()=>D,createLBDLocation:()=>C,createProject:()=>$,createResource:()=>_,deleteResource:()=>u,executeQuery:()=>p,findObjectAliases:()=>P,getAccessRights:()=>j,getAuthorisedFilesInRepository:()=>R,getLBDlocation:()=>A,getLocalContexts:()=>I,getMyArtefactRegistry:()=>S,getMyProjectRepository:()=>M,getProjectDataFromStakeholder:()=>E,getProjectId:()=>v,getProjectsFromAggregator:()=>x,getStakeholdersFromProject:()=>m,loadProjectMetadata:()=>g,update:()=>T,uploadResource:()=>L});var n=r(55877);const a=r(4501),{DataFactory:o}=a,{namedNode:i,literal:s,defaultGraph:c,quad:l}=o,w=r(7265).newEngine,{v4:d}=r(55877);async function p(t,e,r){const n=new a.Store;for(const t of e)try{const e=await r.fetch(t),o=await e.text(),i=new a.Parser;await b(o,n,i,t)}catch(t){console.log(t)}const o="\nprefix ldp: <http://www.w3.org/ns/ldp#> \nprefix lbd: <https://lbdserver.org/vocabulary#>\nprefix dcat: <http://www.w3.org/ns/dcat#>\nprefix owl: <http://www.w3.org/2002/07/owl#> \n "+t,i=w();return await i.query(o,{sources:[n]})}async function f(t,e){try{const r={method:"HEAD"};return 200===(await e.fetch(t,r)).status}catch(e){throw e.message=`Could not check existence of graph ${t} - ${e.message}`,e}}async function u(t,e){try{var r={method:"DELETE"};await e.fetch(t.main,r),await e.fetch(t.metadata,r);var n={method:"PATCH",headers:{"Content-Type":"application/sparql-update"},body:`\nprefix ldp: <http://www.w3.org/ns/ldp#> \nprefix lbd: <https://lbdserver.org/vocabulary#>\nprefix dcat: <http://www.w3.org/ns/dcat#>\nprefix owl: <http://www.w3.org/2002/07/owl#> \n DELETE WHERE {\n    ?art lbd:hasLinkElement ?le .\n    ?le lbd:hasDocument <${t.main}> ; lbd:hasIdentifier ?identifier .\n    ?identifier lbd:identifier ?id .\n  }`,redirect:"follow"};return console.log("resource.artefactRegistry",t.artefactRegistry),void await e.fetch(t.artefactRegistry,n)}catch(t){console.log("error",t)}}async function h(t,e){const r={};for(const n of e)try{const e=await t.bindings();r[n]=e.map((t=>t.get("?"+n).id)).filter((t=>null!=t))}catch(t){console.log("error",t)}return r}async function g(t,e,r){try{const n=await v(t),o=await m(t,r);for(const t of o){const o=await A(t,r)+n+"/artefactRegistry.ttl",i=await r.fetch(o);if(i){const t=await i.text();if(t){const r=new a.Parser;await b(t,e,r,o)}}else console.log(t,"has no artefact registry")}}catch(t){console.log("error",t)}}function y(t,e){if(t.id.startsWith("http"))return i(t.id);if(t.id.startsWith('"')){const e=t.id.replaceAll('"',"");return s(e)}return i(e+t.id)}function b(t,e,r,n){return new Promise(((a,o)=>{t&&r.parse(t,((t,r,o)=>{if(t&&console.log(t),r){const t=y(r.subject,n),a=y(r.predicate,n),o=y(r.object,n),i=l(t,a,o,c());e.addQuad(i)}else a()}))}))}async function x(t,e){let r=t;r.endsWith("/")||(r+="/");const n=await p("\n  SELECT ?project WHERE {\n    ?s a lbd:Aggregator ;\n      ldp:contains ?project .\n  }",[r],e),{project:a}=await h(n,["project"]);return a}async function v(t,e){return t.split("/")[t.split("/").length-2]}async function m(t,e){let r=t;r.endsWith("/")||(r+="/");const n=`\n  SELECT ?st WHERE {\n    <${t}> a lbd:PartialProject ;\n      lbd:hasMember ?st .\n  }`,a=await p(n,[t],e),{st:o}=await h(a,["st"]);return o}async function E(t,e,r){const n=await A(t,r);e.endsWith("/")||(e+="/");const a=n+e;return{stakeholder:t,data:await R(a,r)}}async function R(t,e){const r=`\n    SELECT ?dataset WHERE {\n      <${t}> ldp:contains ?dataset .\n    }\n  `,n=await p(r,[t],e),{dataset:a}=await h(n,["dataset"]),o=a.filter((t=>t.endsWith("props.ttl"))),i=[];for(const r of o){const n=await j(r,e),a="\n    SELECT ?uri WHERE {\n      ?meta a dcat:Dataset ;\n      dcat:distribution ?dist .\n      ?dist dcat:downloadURL ?uri .\n    }",o=await p(a,[r],e),{uri:s}=await h(o,["uri"]);i.push({artefactRegistry:t+"artefactRegistry.ttl",accessRights:n,metadata:r,main:s[0]})}return i}async function j(t,e){return(await e.fetch(t,{method:"HEAD"})).headers.get("WAC-Allow").split(",")[0].replace("user=","").replaceAll('"',"").split(" ")}async function A(t,e){const r=`\nprefix ldp: <http://www.w3.org/ns/ldp#> \nprefix lbd: <https://lbdserver.org/vocabulary#>\nprefix dcat: <http://www.w3.org/ns/dcat#>\nprefix owl: <http://www.w3.org/2002/07/owl#> \n select ?index where {<${t}> lbd:hasProjectRegistry ?index}`,n=await p(r,[t.replace("#me","")],e);let{index:a}=await h(n,["index"]);return a.length>0?(a[0].endsWith("/")||(a+="/"),a[0]):null}async function T(t,e,r){try{var n={method:"PATCH",headers:{"Content-Type":"application/sparql-update"},body:t,redirect:"follow"};let a;return void(a=await r.fetch(e,n))}catch(t){throw console.log("error",t),t}}async function P(t,e,r){const n=`\n  SELECT ?alias WHERE {\n  <${t}> owl:sameAs ?alias .\n  }\n  `,a=await p(n,e,r),{alias:o}=await h(a,["alias"]);return o}async function I(t,e,r){}async function C(t){if(t.info.isLoggedIn){let e=await A(t.info.webId,t);e||(e=t.info.webId.replace("/profile/card#me","/lbd/"));const r=`\nprefix ldp: <http://www.w3.org/ns/ldp#> \nprefix lbd: <https://lbdserver.org/vocabulary#>\nprefix dcat: <http://www.w3.org/ns/dcat#>\nprefix owl: <http://www.w3.org/2002/07/owl#> \n INSERT DATA {\n      <${t.info.webId}> lbd:hasProjectRegistry <${e}> .\n    }`;await T(r,t.info.webId,t);const n=`\nprefix ldp: <http://www.w3.org/ns/ldp#> \nprefix lbd: <https://lbdserver.org/vocabulary#>\nprefix dcat: <http://www.w3.org/ns/dcat#>\nprefix owl: <http://www.w3.org/2002/07/owl#> \n INSERT DATA {\n      <${e}> a lbd:Aggregator .\n    }`;return await T(n,e,t),e}}async function $(t,e,r){if(r.info.isLoggedIn){t||(t=d()),e||(e=[r.info.webId]);let a=await A(r.info.webId,r);a||(a=await C(r));const o=a+t+"/",i=`\nprefix ldp: <http://www.w3.org/ns/ldp#> \nprefix lbd: <https://lbdserver.org/vocabulary#>\nprefix dcat: <http://www.w3.org/ns/dcat#>\nprefix owl: <http://www.w3.org/2002/07/owl#> \n INSERT DATA {\n      <${o}> a lbd:PartialProject ;\n      lbd:hasProjectUri <${o}>;\n      lbd:hasProjectId "${t}";\n      lbd:hasLocalArtefactRegistry <${o}artefactRegistry.ttl> .\n    }`;await T(i,o,r);for(const t of e){const e=`\nprefix ldp: <http://www.w3.org/ns/ldp#> \nprefix lbd: <https://lbdserver.org/vocabulary#>\nprefix dcat: <http://www.w3.org/ns/dcat#>\nprefix owl: <http://www.w3.org/2002/07/owl#> \n INSERT DATA {\n        <${o}> lbd:hasMember <${t}> .\n      }`;await T(e,o,r),await k(t,o,r)}await _(`${o}artefactRegistry.ttl`,{mimeType:"text/turtle"},r),await L(o+".acl",(t=>`\n    @prefix  acl:  <http://www.w3.org/ns/auth/acl#> .       \n      \n    <#${(0,n.v4)()}>\n        a acl:Authorization;\n        acl:accessTo    <./>;\n        acl:default     <./> ;\n        <http://www.w3.org/ns/auth/acl#agent> <${t.info.webId}>;\n        acl:mode <http://www.w3.org/ns/auth/acl#Read>, <http://www.w3.org/ns/auth/acl#Write>, <http://www.w3.org/ns/auth/acl#Append>, <http://www.w3.org/ns/auth/acl#Control>.\n            \n    <#${(0,n.v4)()}>\n        a acl:Authorization;\n        acl:accessTo    <./>;\n        acl:default     <./> ;\n        <http://www.w3.org/ns/auth/acl#agentClass> <http://xmlns.com/foaf/0.1/Agent>;\n        acl:mode <http://www.w3.org/ns/auth/acl#Read>.\n    `)(r),{mimeType:"text/turtle"},r)}}async function S(t,e){return await A(t.info.webId,t)+await v(e)+"/artefactRegistry.ttl"}async function L(t,e,r,n){try{if(!r.overwrite&&await f(t,n))throw new Error("Resource already exists");let o;r.mimeType?o=r.mimeType:(o=mime.lookup(t),!1===o&&(o="text/plain"));var a={method:"PUT",headers:{"Content-Type":o},body:e,redirect:"follow"};let i;return i=await n.fetch(t,a),void(205!==i.status&&(i=await fetch(t,a)))}catch(t){throw console.log("error",t),t.message=`Unable to upload resource - ${t.message}`,t}}async function M(t,e){const r=await A(e.info.webId,e),n=r+await v(t)+"/";if((await x(r,e)).includes(n))return console.log("guess",n),n;throw Error("Can't find your project. Could it be you need to initiate it first?")}async function W(t,e){const r=await p(`prefix ldp: <http://www.w3.org/ns/ldp#> select * where {<${t}> ldp:inbox ?inbox .}`,[t],e),n=await r.bindings();console.log("bind",n);let a=n[0].get("?inbox").id;return a.endsWith("/")||(a+="/"),a}async function D(t){const e=await W(t.info.webId,t),r=await R(e,t),n=await A(t.info.webId,t),a=await x(n,t),o=await query(r,"\n  prefix lbd: <https://lbdserver.org/vocabulary#> \n  prefix as: <https://www.w3.org/ns/activitystreams#> \n  SELECT ?sender WHERE {?invite a lbd:projectInvitation. ?this as:actor ?sender; as:object ?invite .}");await p(query,r,t);const{sender:i}=await h(projects,["sender"]);return o.map((t=>t.sender.value)).filter((t=>!a.includes(t)))}async function _(t,e,r){await L(t,"",e,r)}async function k(t,e,r){const n=r.info.webId,a=await W(t,r)+d()+".ttl",o=`\n  @prefix foaf: <http://xmlns.com/foaf/0.1/>.\n  @prefix solid: <http://www.w3.org/ns/solid/terms#>.\n  @prefix lbd: <https://lbdserver.org/vocabulary#>.\n  @prefix ldp: <http://www.w3.org/ns/ldp#> .\n  @prefix as: <https://www.w3.org/ns/activitystreams#> .\n  @prefix xsd: <http://www.w3.org/2001/XMLSchema#> .\n  @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.\n\n<>\n  a as:Announce ;\n  as:actor <${n}> ;\n  as:object <#invite> ;\n  as:target <${t}> ;\n  as:updated "${(new Date).toISOString()}"^^xsd:dateTime .\n\n<#invite> a lbd:projectInvitation, rdfs:seeAlso <${e}>  .\n  `;await L(a,o,{mimeType:"text/turtle"},r)}},55877:(t,e,r)=>{var n=r(23570),a=r(71171),o=a;o.v1=n,o.v4=a,t.exports=o},45327:t=>{for(var e=[],r=0;r<256;++r)e[r]=(r+256).toString(16).substr(1);t.exports=function(t,r){var n=r||0,a=e;return[a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]]].join("")}},85217:t=>{var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var r=new Uint8Array(16);t.exports=function(){return e(r),r}}else{var n=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),n[e]=t>>>((3&e)<<3)&255;return n}}},23570:(t,e,r)=>{var n,a,o=r(85217),i=r(45327),s=0,c=0;t.exports=function(t,e,r){var l=e&&r||0,w=e||[],d=(t=t||{}).node||n,p=void 0!==t.clockseq?t.clockseq:a;if(null==d||null==p){var f=o();null==d&&(d=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==p&&(p=a=16383&(f[6]<<8|f[7]))}var u=void 0!==t.msecs?t.msecs:(new Date).getTime(),h=void 0!==t.nsecs?t.nsecs:c+1,g=u-s+(h-c)/1e4;if(g<0&&void 0===t.clockseq&&(p=p+1&16383),(g<0||u>s)&&void 0===t.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=u,c=h,a=p;var y=(1e4*(268435455&(u+=122192928e5))+h)%4294967296;w[l++]=y>>>24&255,w[l++]=y>>>16&255,w[l++]=y>>>8&255,w[l++]=255&y;var b=u/4294967296*1e4&268435455;w[l++]=b>>>8&255,w[l++]=255&b,w[l++]=b>>>24&15|16,w[l++]=b>>>16&255,w[l++]=p>>>8|128,w[l++]=255&p;for(var x=0;x<6;++x)w[l+x]=d[x];return e||i(w)}},71171:(t,e,r)=>{var n=r(85217),a=r(45327);t.exports=function(t,e,r){var o=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var i=(t=t||{}).random||(t.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e)for(var s=0;s<16;++s)e[o+s]=i[s];return e||a(i)}}}]);